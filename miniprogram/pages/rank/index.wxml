<view class="page">
  <view class="card">
    <view class="title">æ’è¡Œæ¦œ</view>
    <view wx:if="{{loading}}" class="loading">åŠ è½½ä¸­...</view>
    <view wx:else>
      <!-- ç©ºçŠ¶æ€ -->
      <view wx:if="{{ranks.length === 0}}" class="empty-container">
        <view class="empty-icon">ğŸ“Š</view>
        <view class="empty-text">æš‚æ— æ’è¡Œæ•°æ®ï¼Œå¿«å»å¯¹æˆ˜å§</view>
      </view>
      <!-- æ’è¡Œæ¦œåˆ—è¡¨ -->
      <view wx:else class="list">
        <block wx:for="{{ranks}}" wx:key="rank">
          <view class="item {{item.isCurrentUser ? 'current-user' : ''}} {{item.rank <= 3 ? 'top-three' : ''}}">
            <!-- å·¦ä¾§æ’ååŒº -->
            <view class="rank-area">
              <view wx:if="{{item.rank === 1}}" class="medal">ğŸ¥‡</view>
              <view wx:elif="{{item.rank === 2}}" class="medal">ğŸ¥ˆ</view>
              <view wx:elif="{{item.rank === 3}}" class="medal">ğŸ¥‰</view>
              <view wx:else class="rank-number">{{item.rank}}</view>
            </view>
            <!-- ä¸­é—´ç”¨æˆ·åŒº -->
            <view class="user-area">
              <image 
                class="avatar" 
                src="{{item.avatarUrl || '/images/icons/avatar.png'}}" 
                mode="aspectFill"
                lazy-load="true"
                binderror="onAvatarError"
                data-index="{{index}}"
              ></image>
              <view class="user-info">
                <view class="name">{{item.name || 'æœªå‘½å'}}</view>
                <view class="sub-info">èƒœç‡{{item.winRate || 0}}% Â· å…±{{item.totalGames || 0}}åœº</view>
              </view>
            </view>
            <!-- å³ä¾§æ•°æ®åŒº -->
            <view class="data-area">
              <view class="record">{{item.wins || 0}}èƒœ {{item.loses || 0}}è´Ÿ</view>
              <view class="streak">æœ€é«˜è¿èƒœ {{item.streak || 0}}</view>
            </view>
          </view>
        </block>
        <!-- å½“å‰ç”¨æˆ·æ’åæç¤º -->
        <!-- æœªç™»å½•ï¼šæ˜¾ç¤ºç™»å½•æç¤º -->
        <view wx:if="{{!currentUser || currentUser.notLogin}}" class="rank-footer">
          <view class="rank-footer-text">æœªç™»å½•ï¼Œç™»å½•åæ˜¾ç¤ºæˆ‘çš„æ’å</view>
        </view>
        <!-- å·²ç™»å½•ä¸”å·²ä¸Šæ¦œï¼šæ˜¾ç¤ºæ’å -->
        <view wx:elif="{{currentUser && !currentUser.notLogin && !currentUser.notRanked && currentUser.rank}}" class="rank-footer">
          <view class="rank-footer-text">ä½ å½“å‰æ’åï¼šç¬¬ {{currentUser.rank}} å</view>
        </view>
        <!-- å·²ç™»å½•ä½†æœªä¸Šæ¦œï¼šæ˜¾ç¤ºæœªä¸Šæ¦œæç¤º -->
        <view wx:elif="{{currentUser && !currentUser.notLogin && currentUser.notRanked && !loading}}" class="rank-footer">
          <view class="rank-footer-text">æœªä¸Šæ¦œï¼ˆè‡³å°‘å¯¹æˆ˜ 5 åœºï¼‰<text wx:if="{{currentUser.needGames > 0}}">ï¼Œè¿˜å·® {{currentUser.needGames}} åœº</text></view>
        </view>
      </view>
    </view>
  </view>
</view>
